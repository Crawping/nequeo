CREATE TABLE [dbo].[User] (
    [UserID]                                 BIGINT         IDENTITY (1, 1) NOT NULL,
    [Username]                               VARCHAR (100)  NOT NULL,
    [Password]                               VARCHAR (500)  NOT NULL,
    [ApplicationLoginUserID]                 BIGINT         CONSTRAINT [DF_User_ApplicationLoginUserID] DEFAULT ((1)) NOT NULL,
    [UserSuspended]                          BIT            CONSTRAINT [DF_User_UserSuspended] DEFAULT ((0)) NOT NULL,
    [LoggedIn]                               BIT            CONSTRAINT [DF_User_LoggedIn] DEFAULT ((0)) NOT NULL,
    [LastLoginDate]                          DATETIME       CONSTRAINT [DF_User_LastLoginDate] DEFAULT (getdate()) NOT NULL,
    [Email]                                  VARCHAR (300)  NOT NULL,
    [PasswordQuestion]                       NVARCHAR (500) NULL,
    [PasswordAnswer]                         NVARCHAR (500) NULL,
    [ApplicationName]                        NVARCHAR (300) NOT NULL,
    [FailedPasswordAttemptCount]             INT            CONSTRAINT [DF_User_FailedPasswordAttemptCount] DEFAULT ((0)) NOT NULL,
    [FailedPasswordAttemptWindowStart]       DATETIME       CONSTRAINT [DF_User_FailedPasswordAttemptWindowStart] DEFAULT (getdate()) NOT NULL,
    [FailedPasswordAnswerAttemptCount]       INT            CONSTRAINT [DF_User_FailedPasswordAnswerAttemptCount] DEFAULT ((0)) NOT NULL,
    [FailedPasswordAnswerAttemptWindowStart] DATETIME       CONSTRAINT [DF_User_FailedPasswordAnswerAttemptWindowStart] DEFAULT (getdate()) NOT NULL,
    [UserSuspendedDate]                      DATETIME       CONSTRAINT [DF_User_UserSuspendedDate] DEFAULT (getdate()) NOT NULL,
    [LastPasswordChangedDate]                DATETIME       CONSTRAINT [DF_User_LastPasswordChangedDate] DEFAULT (getdate()) NOT NULL,
    [LastActivityDate]                       DATETIME       CONSTRAINT [DF_User_LastActivityDate] DEFAULT (getdate()) NOT NULL,
    [CreationDate]                           DATETIME       CONSTRAINT [DF_User_CreationDate] DEFAULT (getdate()) NOT NULL,
    [IsApproved]                             BIT            CONSTRAINT [DF_User_IsApproved] DEFAULT ((1)) NOT NULL,
    [Comments]                               NVARCHAR (MAX) NULL,
    [RoleID]                                 BIGINT         NULL,
    [ProfileID]                              BIGINT         NULL,
    CONSTRAINT [PK_User] PRIMARY KEY CLUSTERED ([UserID] ASC),
    CONSTRAINT [FK_User_Profile] FOREIGN KEY ([ProfileID]) REFERENCES [dbo].[Profile] ([ProfileID]),
    CONSTRAINT [FK_User_Role] FOREIGN KEY ([RoleID]) REFERENCES [dbo].[Role] ([RoleID]),
    CONSTRAINT [IX_UsernameApplicationName] UNIQUE NONCLUSTERED ([Username] ASC, [ApplicationName] ASC)
);

